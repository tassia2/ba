<Param>
    <OutputPrefix>ChannelBenchmark</OutputPrefix>
    <Mesh>
        <Filename12>unit_square.inp</Filename12>
        <Filename1>dfg2d_rect.inp</Filename1>
        <Filename2>dfg_bench3d_rect2.inp</Filename2>
        <SequentialRefLevel>0</SequentialRefLevel>
        <InitialRefLevel>2</InitialRefLevel>
    </Mesh>
    <UseBoundaryDomainDescriptor>0</UseBoundaryDomainDescriptor>
    <LinearAlgebra>
        <Platform>CPU</Platform>
        <Implementation>Naive</Implementation>
        <MatrixFormat>CSR</MatrixFormat>
        <Numbering>Classic</Numbering>
        <OrderFEbeforeCell>0</OrderFEbeforeCell>
    </LinearAlgebra>
    <FlowModel>
        <Density>1.0</Density>
        <Viscosity>1.0e-3</Viscosity>
        <InflowSpeed>2.25</InflowSpeed><!-- 2.25 -->
        <InflowHeight>0.41</InflowHeight><!-- 0.41 -->
        <InflowWidth>0.41</InflowWidth>
    </FlowModel>
    <DFGbenchmark>0</DFGbenchmark>
    <BenchQuantities>0</BenchQuantities>
    <QuadratureOrder>6</QuadratureOrder>
    <FiniteElements>
        <VelocityDegree>2</VelocityDegree>
        <PressureDegree>1</PressureDegree>
    </FiniteElements>
    <Instationary>
        <SolveInstationary>1</SolveInstationary>
        <Method>CrankNicolson</Method>
        <Timestep>0.001</Timestep>
        <Endtime>1.00</Endtime>
    </Instationary>
    <Boundary>
        <InflowMaterial>15</InflowMaterial>
        <OutflowMaterial>16</OutflowMaterial>
        <CylinderMaterial>14</CylinderMaterial>
    </Boundary>
    <NonlinearSolver>
        <UseHiFlowNewton>1</UseHiFlowNewton>
        <MaximumIterations>5</MaximumIterations>
        <AbsoluteTolerance>1.e-15</AbsoluteTolerance>
        <RelativeTolerance>1.e-6</RelativeTolerance>
        <DivergenceLimit>1.e6</DivergenceLimit>
        <ArmijoUpdate>0</ArmijoUpdate>
        <ThetaInitial>0</ThetaInitial>
        <ThetaMinimal>0</ThetaMinimal>
        <ArmijoDecrease>0</ArmijoDecrease>
        <SufficientDecrease>0</SufficientDecrease>
        <MaxArmijoIteration>0</MaxArmijoIteration>
        <ForcingStrategy>EisenstatWalker1</ForcingStrategy>
        <ConstantForcingTerm>1.e-4</ConstantForcingTerm>
        <InitialValueForcingTerm>1.e-3</InitialValueForcingTerm>
        <MaxValueForcingTerm>0.9</MaxValueForcingTerm>
        <GammaParameterEW2>0.9</GammaParameterEW2>
        <AlphaParameterEW2>2</AlphaParameterEW2>
    </NonlinearSolver>
    <!--- WARNING: Pressure filter might not be suitable for the current formulation of the problem -->
    <UsePressureFilter>0</UsePressureFilter>
    <Backup>
        <Restore>0</Restore>
        <LastTimeStep>160</LastTimeStep>
        <Filename>backup.h5</Filename>
    </Backup>
    <LinearSolver>
        <PrimalSolver>
            <Name>OuterLinSolver</Name>
            <Type>FGMRES</Type>
            <PrecondType>GMG</PrecondType>            <!-- BlockJacobiStd, BlockJacobiExt , GMG, (AMG, Richardson), Vanka -->
            <MaxIt>500</MaxIt>
            <AbsTol>1.e-20</AbsTol>
            <RelTol>1.e-10</RelTol>
            <DivLimit>1.e6</DivLimit>
            <KrylovSize>500</KrylovSize>
            <ReuseBasis>1</ReuseBasis>
            <UsePrecond>1</UsePrecond>
            <UsePressureFilterOuter>0</UsePressureFilterOuter><!-- Pressure filter applied to result of linear problem solver (for Newton Method-> other flag is valid)-->
            <UsePressureFilter>0</UsePressureFilter>          <!-- Pressure filter within each Krylov iteration -->
            <PrintLevel>0</PrintLevel>
            <Reuse>1</Reuse>
            <UpdateFreqNewton>1</UpdateFreqNewton>             
            <UpdateFreqTime>1</UpdateFreqTime>
        </PrimalSolver>
        <Preconditioner>
            <Richardson>
                <Iterations>2</Iterations>
                <Damping>0.5</Damping>
                <Preconditioner>BlockJacobi</Preconditioner>
            </Richardson>
            <BlockJacobi>
                <LocalSolverType>ILUPP</LocalSolverType>        <!-- ILUPP, HiflowILU, SOR, Jacobi, MklLU, MklILU, UmfpackLU, Vanka, FSAI --> 
            </BlockJacobi>
            <GMG>
                <SmootherType>ILUPP</SmootherType>
                <CycleType>V</CycleType>
                <Iterations>1</Iterations>
                <NumLevel>3</NumLevel>
                <TransposedP>1</TransposedP>
                <PreSmoothingSteps>2</PreSmoothingSteps>
                <PostSmoothingSteps>2</PostSmoothingSteps>
                <SmootherRelax>1.</SmootherRelax>
                <NestedIteration>0</NestedIteration>
                <PrintLevel>0</PrintLevel>
                <CoarseSolver>
                    <Name>CoarseSolver</Name>
                    <Type>GMRES</Type>
                    <PrecondType>BlockJacobiExt</PrecondType>   <!-- BlockJacobiStd, BlockJacobiExt, Vanka --> 
                    <LocalSolverType>ILUPP</LocalSolverType>
                    <MaxIt>100</MaxIt>
                    <AbsTol>1.e-20</AbsTol>
                    <RelTol>1.e-10</RelTol>
                    <DivLimit>1.e6</DivLimit>
                    <KrylovSize>100</KrylovSize>
                    <ReuseBasis>1</ReuseBasis>
                    <UsePrecond>1</UsePrecond>
                    <UsePressureFilterOuter>0</UsePressureFilterOuter>  <!-- Pressure filter applied to result of linear problem solver (for Newton Method-> other flag is valid)-->
                    <UsePressureFilter>0</UsePressureFilter>            <!-- Pressure filter within each Krylov iteration -->
                    <PrintLevel>0</PrintLevel>
                    <Reuse>1</Reuse>
                </CoarseSolver>
                <KrylovSmoother>
                    <Name>Smoother</Name>
                    <Type>GMRES</Type>
                    <PrecondType>BlockJacobiExt</PrecondType>   <!-- BlockJacobiStd, BlockJacobiExt, Vanka --> 
                    <LocalSolverType>ILUPP</LocalSolverType>
                    <MaxIt>100</MaxIt>
                    <AbsTol>1.e-20</AbsTol>
                    <RelTol>1.e-4</RelTol>
                    <DivLimit>1.e6</DivLimit>
                    <KrylovSize>100</KrylovSize>
                    <ReuseBasis>1</ReuseBasis>
                    <UsePrecond>1</UsePrecond>
                    <UsePressureFilterOuter>0</UsePressureFilterOuter>  <!-- Pressure filter applied to result of linear problem solver (for Newton Method-> other flag is valid)-->
                    <UsePressureFilter>0</UsePressureFilter>            <!-- Pressure filter within each Krylov iteration -->
                    <PrintLevel>0</PrintLevel>
                    <Reuse>1</Reuse>
                </KrylovSmoother>
            </GMG>
        </Preconditioner>
        <LocalSolver>
            <ILUPP>
                <PreprocessingType>0</PreprocessingType>
                <PreconditionerNumber>11</PreconditionerNumber>
                <MaxMultilevels>20</MaxMultilevels>
                <MemFactor>0.8</MemFactor>
                <PivotThreshold>2.75</PivotThreshold>
                <MinPivot>0.05</MinPivot>                              <!-- 0.01, 0.05 -->           
            </ILUPP>
            <HiflowILU>
                <Bandwidth>0</Bandwidth>
            </HiflowILU>
            <MklILU>
                <Bandwidth>1</Bandwidth>
                <RegularizeDiag>1</RegularizeDiag>
                <DiagThreshold>1e-16</DiagThreshold>
                <DiagEps>1e-10</DiagEps>                     
            </MklILU>
            <MklLU>
                <IterativeRefinement>1</IterativeRefinement>
            </MklLU>
            <UmfpackLU>
                <IterativeRefinement>1</IterativeRefinement>
                <PivotTol>0.1</PivotTol>
                <ScaleSum>1</ScaleSum>
                <ScaleMax>0</ScaleMax>
            </UmfpackLU>
            <Vanka>
                <Damping>1.</Damping>
                <Iterations>1</Iterations>
                <BlockCells>0</BlockCells>
            </Vanka>
            <SSOR>
                <Omega>1.</Omega>
            </SSOR>
            <SOR>
                <Omega>1.</Omega>
            </SOR>
            <FSAI>
                <Iterations>1000</Iterations>
                <RelRes>1e-10</RelRes>
                <AbsRes>1e-10</AbsRes>
                <Power>1</Power>
            </FSAI>
            <Jacobi>
            </Jacobi>
        </LocalSolver>
    </LinearSolver> 
</Param>
